apiVersion: v1
kind: Secret
metadata:
  name: bazel-config
  namespace: apps
type: Opaque
stringData:
  configuration: |-
    # https://github.com/buchgr/bazel-remote#example-configuration-file
    dir: /cache
    max_size: 50
    http_address: 0.0.0.0:8080
    grpc_address: 0.0.0.0:9092
    experimental_remote_asset_api: true
    access_log_level: none
    enable_endpoint_metrics: true
    s3_proxy:
      endpoint: "${BUCKET_HOST}:${BUCKET_PORT}"
      bucket: ${BUCKET_NAME}
      prefix: bazel/cache-
      disable_ssl: true
      auth_method: access_key
      access_key_id: ${AWS_ACCESS_KEY_ID}
      secret_access_key: ${AWS_SECRET_ACCESS_KEY}
