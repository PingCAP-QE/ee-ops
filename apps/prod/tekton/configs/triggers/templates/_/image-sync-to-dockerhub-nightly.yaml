apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: image-sync-to-dockerhub-nightly
spec:
  params:
    - name: image_url
      description: The image full url for pull
    - name: tag
      description: The image tag
    - name: target_img
      description: The artifact tag
  resourcetemplates:
      - apiVersion: tekton.dev/v1beta1
        kind: TaskRun
        metadata:
          generateName: copy-image-dockerhub-
        spec:
          params:
          - name: src-image-url
            value: $(tt.params.image_url)
          - name: dst-image-url
            value: $(tt.params.target_img):$(tt.params.tag)
          serviceAccountName: image-releaser
          taskRef:
            name: crane-copy
      - apiVersion: tekton.dev/v1beta1
        kind: TaskRun
        metadata:
          generateName: copy-image-dockerhub-
        spec:
          params:
          - name: src-image-url
            value: $(tt.params.image_url)
          - name: dst-image-url
            value: $(tt.params.target_img):nightly
          serviceAccountName: image-releaser
          taskRef:
            name: crane-copy
