apiVersion: triggers.tekton.dev/v1beta1
kind: TriggerTemplate
metadata:
  name: push-tikv-pd
spec:
  params:
    - name: git-url
      description: The git repository full url
    - name: git-revision
      description: The git revision
  resourcetemplates:
    - apiVersion: tekton.dev/v1beta1
      kind: PipelineRun
      metadata:
        generateName: push-build-tikv-pd-
        annotations:
          "tekton.dev/git-status": "true"
          "tekton.dev/status-target-url": "https://do.pingcap.net/tekton/#/namespaces/{{ .Namespace }}/pipelineruns/{{ .Name }}"
          "tekton.dev/git-repo": $(tt.params.git-url)
          "tekton.dev/git-revision": $(tt.params.git-revision)
      spec:
        pipelineSpec:
          params:
            - name: git-url
              type: string
            - name: git-revision
              default: main
              type: string
          tasks:
            - name: checkout
              params:
                - name: url
                  value: $(params.git-url)
                - name: revision
                  value: $(params.git-revision)
              taskRef:
                kind: Task
                name: git-clone
            - name: build-rc
              taskSpec:
                metadata: {}
                spec: null
                steps:
                  - image: ubuntu
                    name: echo
                    resources: {}
                    script: |
                      #!/usr/bin/env bash

                      echo "WIP, current not ready"

        params:
          - name: git-url
            value: $(tt.params.git-url)
          - name: git-revision
            value: $(tt.params.git-revision)
