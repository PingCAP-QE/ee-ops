apiVersion: tekton.dev/v1beta1
kind: Pipeline
metadata:
  name: auto-compose-multi-arch-image
spec:
  params:
    - name: image_url
      description: The image full url for pull
    - name: tag
      description: The pushed image tag
  workspaces:
    - name: dockerconfig
      description: Includes a docker `config.json`   
  tasks:
    - name: collect-and-push
      taskRef:
        name: multi-arch-image-collect
      params:
        - name: image_url
          value: "$(params.image_url)"
        - name: release_tag_suffix
          value: release
      workspaces:
        - name: dockerconfig
          workspace: dockerconfig
